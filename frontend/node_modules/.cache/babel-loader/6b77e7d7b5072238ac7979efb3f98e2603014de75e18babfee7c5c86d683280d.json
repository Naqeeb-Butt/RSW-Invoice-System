{"ast":null,"code":"import React,{useState,useEffect}from'react';import axios from'axios';import{Link}from'react-router-dom';import{Plus,Search,Filter,Download,Upload,Eye,Edit,Trash2,Calendar}from'lucide-react';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";export default function Invoices(){const[invoices,setInvoices]=useState([]);const[loading,setLoading]=useState(true);const[searchTerm,setSearchTerm]=useState('');const[statusFilter,setStatusFilter]=useState('');const[showImportModal,setShowImportModal]=useState(false);useEffect(()=>{fetchInvoices();},[statusFilter]);const fetchInvoices=async()=>{try{const params={};if(statusFilter)params.status=statusFilter;const response=await axios.get('/api/v1/invoices',{params});setInvoices(response.data);}catch(error){console.error('Failed to fetch invoices:',error);}finally{setLoading(false);}};const handleExport=async()=>{try{const response=await axios.post('/api/v1/invoices/export',{},{responseType:'blob'});const url=window.URL.createObjectURL(new Blob([response.data]));const link=document.createElement('a');link.href=url;link.setAttribute('download','invoices.xlsx');document.body.appendChild(link);link.click();link.remove();}catch(error){console.error('Export failed:',error);}};const handleImport=async file=>{const formData=new FormData();formData.append('file',file);try{const response=await axios.post('/api/v1/invoices/import',formData);alert(\"Successfully imported \".concat(response.data.imported,\" invoices\"));fetchInvoices();setShowImportModal(false);}catch(error){console.error('Import failed:',error);alert('Import failed. Please check the file format.');}};const handleDelete=async invoiceId=>{if(!window.confirm('Are you sure you want to delete this invoice?')){return;}try{await axios.delete(\"/api/v1/invoices/\".concat(invoiceId));setInvoices(invoices.filter(inv=>inv.id!==invoiceId));}catch(error){console.error('Failed to delete invoice:',error);}};const formatCurrency=amount=>{return new Intl.NumberFormat('en-US',{style:'currency',currency:'USD'}).format(amount);};const formatDate=dateString=>{return new Date(dateString).toLocaleDateString();};const getStatusColor=status=>{switch(status){case'paid':return'bg-green-100 text-green-800';case'sent':return'bg-blue-100 text-blue-800';case'overdue':return'bg-red-100 text-red-800';case'draft':return'bg-gray-100 text-gray-800';default:return'bg-gray-100 text-gray-800';}};const filteredInvoices=invoices.filter(invoice=>invoice.invoice_number.toLowerCase().includes(searchTerm.toLowerCase())||invoice.client.name.toLowerCase().includes(searchTerm.toLowerCase()));if(loading){return/*#__PURE__*/_jsx(\"div\",{className:\"flex items-center justify-center h-64\",children:/*#__PURE__*/_jsx(\"div\",{className:\"animate-spin rounded-full h-8 w-8 border-b-2 border-aasko-blue\"})});}return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"div\",{className:\"mb-8\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h1\",{className:\"text-2xl font-bold text-gray-900\",children:\"Invoices\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-600\",children:\"Manage your invoices and billing\"})]}),/*#__PURE__*/_jsxs(Link,{to:\"/invoices/new\",className:\"btn btn-primary flex items-center\",children:[/*#__PURE__*/_jsx(Plus,{className:\"h-4 w-4 mr-2\"}),\"Create Invoice\"]})]})}),/*#__PURE__*/_jsx(\"div\",{className:\"card p-6 mb-6\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex flex-col sm:flex-row gap-4\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"flex-1\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"relative\",children:[/*#__PURE__*/_jsx(Search,{className:\"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"Search invoices...\",value:searchTerm,onChange:e=>setSearchTerm(e.target.value),className:\"input-field pl-10\"})]})}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex gap-2\",children:[/*#__PURE__*/_jsxs(\"select\",{value:statusFilter,onChange:e=>setStatusFilter(e.target.value),className:\"input-field\",children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"All Status\"}),/*#__PURE__*/_jsx(\"option\",{value:\"draft\",children:\"Draft\"}),/*#__PURE__*/_jsx(\"option\",{value:\"sent\",children:\"Sent\"}),/*#__PURE__*/_jsx(\"option\",{value:\"paid\",children:\"Paid\"}),/*#__PURE__*/_jsx(\"option\",{value:\"overdue\",children:\"Overdue\"})]}),/*#__PURE__*/_jsxs(\"button\",{onClick:handleExport,className:\"btn btn-secondary flex items-center\",children:[/*#__PURE__*/_jsx(Download,{className:\"h-4 w-4 mr-2\"}),\"Export\"]}),/*#__PURE__*/_jsxs(\"button\",{onClick:()=>setShowImportModal(true),className:\"btn btn-secondary flex items-center\",children:[/*#__PURE__*/_jsx(Upload,{className:\"h-4 w-4 mr-2\"}),\"Import\"]})]})]})}),/*#__PURE__*/_jsxs(\"div\",{className:\"card overflow-hidden\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"overflow-x-auto\",children:/*#__PURE__*/_jsxs(\"table\",{className:\"min-w-full divide-y divide-gray-200\",children:[/*#__PURE__*/_jsx(\"thead\",{className:\"bg-gray-50\",children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{className:\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\",children:\"Invoice #\"}),/*#__PURE__*/_jsx(\"th\",{className:\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\",children:\"Client\"}),/*#__PURE__*/_jsx(\"th\",{className:\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\",children:\"Date\"}),/*#__PURE__*/_jsx(\"th\",{className:\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\",children:\"Due Date\"}),/*#__PURE__*/_jsx(\"th\",{className:\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\",children:\"Amount\"}),/*#__PURE__*/_jsx(\"th\",{className:\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\",children:\"Status\"}),/*#__PURE__*/_jsx(\"th\",{className:\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\",children:\"Actions\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{className:\"bg-white divide-y divide-gray-200\",children:filteredInvoices.map(invoice=>/*#__PURE__*/_jsxs(\"tr\",{className:\"hover:bg-gray-50\",children:[/*#__PURE__*/_jsx(\"td\",{className:\"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900\",children:invoice.invoice_number}),/*#__PURE__*/_jsx(\"td\",{className:\"px-6 py-4 whitespace-nowrap text-sm text-gray-900\",children:invoice.client.name}),/*#__PURE__*/_jsx(\"td\",{className:\"px-6 py-4 whitespace-nowrap text-sm text-gray-500\",children:formatDate(invoice.invoice_date)}),/*#__PURE__*/_jsx(\"td\",{className:\"px-6 py-4 whitespace-nowrap text-sm text-gray-500\",children:invoice.due_date?formatDate(invoice.due_date):'-'}),/*#__PURE__*/_jsx(\"td\",{className:\"px-6 py-4 whitespace-nowrap text-sm text-gray-900\",children:formatCurrency(invoice.total_amount)}),/*#__PURE__*/_jsx(\"td\",{className:\"px-6 py-4 whitespace-nowrap\",children:/*#__PURE__*/_jsx(\"span\",{className:\"inline-flex px-2 py-1 text-xs font-semibold rounded-full \".concat(getStatusColor(invoice.status)),children:invoice.status})}),/*#__PURE__*/_jsx(\"td\",{className:\"px-6 py-4 whitespace-nowrap text-sm font-medium\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-2\",children:[/*#__PURE__*/_jsx(Link,{to:\"/invoices/\".concat(invoice.id),className:\"text-aasko-blue hover:text-aasko-blue-dark\",children:/*#__PURE__*/_jsx(Eye,{className:\"h-4 w-4\"})}),/*#__PURE__*/_jsx(Link,{to:\"/invoices/\".concat(invoice.id,\"/edit\"),className:\"text-gray-600 hover:text-gray-900\",children:/*#__PURE__*/_jsx(Edit,{className:\"h-4 w-4\"})}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>handleDelete(invoice.id),className:\"text-red-600 hover:text-red-900\",children:/*#__PURE__*/_jsx(Trash2,{className:\"h-4 w-4\"})})]})})]},invoice.id))})]})}),filteredInvoices.length===0&&/*#__PURE__*/_jsx(\"div\",{className:\"text-center py-12\",children:/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-500\",children:\"No invoices found\"})})]}),showImportModal&&/*#__PURE__*/_jsx(\"div\",{className:\"fixed inset-0 bg-gray-600 bg-opacity-50 flex items-center justify-center z-50\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-lg p-6 max-w-md w-full\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-lg font-medium text-gray-900 mb-4\",children:\"Import Invoices\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-gray-600 mb-4\",children:\"Upload an Excel file containing invoice data. The file should include columns for Invoice Number, Client, Date, Status, and Total Amount.\"}),/*#__PURE__*/_jsx(\"input\",{type:\"file\",accept:\".xlsx,.xls\",onChange:e=>{const file=e.target.files[0];if(file){handleImport(file);}},className:\"input-field\"}),/*#__PURE__*/_jsx(\"div\",{className:\"mt-4 flex justify-end space-x-2\",children:/*#__PURE__*/_jsx(\"button\",{onClick:()=>setShowImportModal(false),className:\"btn btn-secondary\",children:\"Cancel\"})})]})})]});}","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}